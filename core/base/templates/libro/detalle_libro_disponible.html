{% extends 'layout.html' %}
{% load static %}

{% block head %}
    <script src="{% static 'lib/highcharts-8.1.2/highcharts.js' %}"></script>
    <script src="{% static 'lib/highcharts-8.1.2/modules/exporting.js' %}"></script>
    <script src="{% static 'lib/highcharts-8.1.2/modules/export-data.js' %}"></script>
    <script src="{% static 'lib/highcharts-8.1.2/modules/accessibility.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@2.2.4/dist/jquery.min.js"></script>
    <script src="{% static 'lib/adminlte-3.0.4/plugins/jquery/jquery.min.js' %}"></script>
    <script src="{% static 'libro/js/reservas_vencidas.js' %}"></script>
    <script src="{% static 'libro/js/libro.js' %}"></script>

{% endblock %}

{% block content %}
 <div class="card">
    <div class="card-header">
        <div class="row" style="margin: 30px;">
            <div class="col-md-12 text-center ">
                <strong class="card-title">
                    <h2>{{ object }}</h2>
                </strong>
            </div>
        </div>

        <div class="container">
            <div class="row">
                <div class="card" >
                    {% csrf_token %}
                    <img class="card-img-top img-fluid d-block mx-auto" style="width: 400px; height: 500px;" src="{{ object.imagen.url }}" alt="Card image cap">
                    <div class="card-body">
                        <div class="row">
                            
                            <div class="col-md-4 pb-3">
                                <p class="card-text"><strong>Autor</strong></p>{{ object.autor }}
                            </div>
                            <div class="col-md-4 pb-3">
                                <p class="card-text"><strong>Genero</strong></p>{{ object.genero}}
                            </div>
                            <div class="col-md-4">
                                <p class="card-text"><strong>Publicado el:</strong></p> {{ object.f_publicacion }}
                            </div>
                            <div class="col-md-12">
                                <p class="card-text"><strong>Descripcion</strong></p>
                            </div>
                            <div class="col-md-12">
                                <p class="card-text">{{ object.descripcion }}</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <button type="button" class="btn btn-primary btn-lg" onclick="registrarReserva();">Reservar Libro</button>
                    <button type="button" class="btn btn-success btn-lg"><a href="{% url 'base:libros_disponibles' %}"style="color:white;">Volver</button>
                </div>
            </div>
        </div>

    </div>
</div>

<script type="text/javascript">
    function registrarReserva(){
        data = {
            'user': "{{ request.user.id }}",
            'libro':"{{ object.id }}",
            csrfmiddlewaretoken: $("[name='csrfmiddlewaretoken']").val()
        }
        $.ajax({
            data:data,
            url:"{% url 'base:reservar_libro' %}",
            type: 'POST',
            success:function(response){
                notificacionSuccess(response.mensaje);
                window.location.href = response.url;
            },
            error:function(error){
                notificacionError(error.responseJSON.mensaje);
            },
            
        });
    }
</script>

{% endblock %}